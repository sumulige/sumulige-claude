# Sumulige Claude 渐进式指南

> 从零开始，逐步理解项目的核心设计理念

---

## Level 1: 基础概念 (5 分钟)

### Q: sumulige-claude 是什么？

**一句话答案**：它是 Claude Code 的"能力扩展器"。

**类比理解**：

```
Claude Code       =  一辆基础款汽车
sumulige-claude   =  给汽车加装：
                      ├─ 导航系统 (Template)
                      ├─ 自动驾驶 (Agents)
                      └─ 第三方配件接口 (Skills)
```

**核心价值**：
1. **记忆** - 记住你的项目决策
2. **分工** - 不同 AI 专注不同任务
3. **复用** - 技能可以在项目间共享

---

## Level 2: 目录结构理解 (10 分钟)

### Q: 为什么要保留在项目中？

**传统 CLI 工具**：
```
npm install -g tool    → 全局安装
tool command           → 到处都能用
```

**sumulige-claude**：
```
npm install -g sumulige-claude    → 全局安装框架
smc template                      → 每个项目专属配置
```

**关键区别**：

| 特性 | 传统 CLI | sumulige-claude |
|------|---------|-----------------|
| 安装位置 | 全局 | 全局框架 + 项目配置 |
| 配置方式 | 一个全局配置 | 每个项目独立配置 |
| 记忆能力 | 无 | 项目级记忆 (RAG) |
| 团队协作 | 每人各自配置 | 配置随项目共享 |

**为什么这样设计？**

```
┌─────────────────────────────────────────────────────────────┐
│  场景：你有一个团队，大家在同一个项目上工作                   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  传统方式：                                                  │
│  ├─ 每个人自己配置 Claude                                   │
│  ├─ 张三用 Opus，李四用 Sonnet                              │
│  ├─ 王五知道项目架构，赵六不知道                             │
│  └─ 结果：代码风格不一致，决策不统一                         │
│                                                             │
│  sumulige-claude 方式：                                      │
│  ├─ git clone 项目                                          │
│  ├─ smc sync 获取统一配置                                   │
│  ├─ 所有人使用相同的 Agent 定义                              │
│  └─ RAG 系统让所有人了解项目历史                            │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## Level 3: 两个目录的区别 (15 分钟)

### Q: `.claude/` 和 `template/.claude/` 有什么不同？

**最简单的理解**：

```
template/.claude/   =  工厂 (生产配置)
.claude/            =  家 (你实际使用的配置)
```

**类比**：

```
template/.claude/              你的项目 .claude/
     │                              │
     ▼                              ▼
🏭 工厂                        🏠 你的家
├─ 蓝图                        ├─ 实际建筑
├─ 生产线                      ├─ 家具物品
└─ 模板                        └─ 个人物品

(无状态，不可变)              (有状态，可变化)
```

**详细对比**：

| 维度 | `template/.claude/` | 项目 `.claude/` |
|------|---------------------|-----------------|
| **性质** | 模板 | 实例 |
| **状态** | 只读 | 可写 |
| **内容** | commands/, skills/, hooks/ | + sessions/, rag/ |
| **Git 追踪** | 完整提交 | sessions/ 忽略 |
| **更新方式** | npm update | smc sync |

**工作流程**：

```
┌──────────────────────┐
│  template/.claude/   │  npm 包的一部分
│  (能力定义)           │  定义"能做什么"
└──────────┬───────────┘
           │ smc template
           ▼
┌──────────────────────┐
│  项目/.claude/       │  项目的一部分
│  (运行状态)           │  记录"做过什么"
│  ├─ commands/        │  (来自模板)
│  ├─ skills/          │  (来自模板)
│  ├─ sessions/        │  (新增：对话记录)
│  └─ rag/             │  (新增：项目知识)
└──────────────────────┘
```

---

## Level 4: 命令选择 (20 分钟)

### Q: `smc template` vs `smc sync`？

**决策树**：

```
你的项目
    │
    ├─ 是空的？
    │   └─ 是 → smc template
    │          (全屋装修)
    │
    └─ 已有文件？
        └─ 是 → smc sync
               (添置家具)
```

**详细对比**：

| 操作 | `smc template` | `smc sync` |
|------|----------------|------------|
| **用途** | 新项目初始化 | 现有项目更新 |
| **行为** | 完整覆盖 | 增量同步 |
| **风险** | 会覆盖已有文件 | 只补缺失的 |
| **sessions/** | 创建空目录 | 完整保留 |

**安全选项** (v1.1.0+)：

```bash
smc template        # 默认：覆盖前备份
smc template --safe # 跳过已存在的文件
smc template --force# 强制覆盖，不备份
```

---

## Level 5: 更新机制 (25 分钟)

### Q: 如何更新到新版本？

**三层结构**：

```
┌─────────────────────────────────────────────────────────────┐
│  全局层 (~/.claude/)      →  工具箱                         │
│  项目层 (./.claude/)      →  工作台                         │
│  代码层 (node_modules/)   →  零件                           │
└─────────────────────────────────────────────────────────────┘
```

**更新流程**：

```bash
# 1️⃣ 更新全局包 (新零件)
npm update -g sumulige-claude

# 2️⃣ 同步到项目 (组装到工作台)
cd your-project
smc sync
```

**为什么需要两步？**

```
npm update                    smc sync
     │                            │
     ▼                            ▼
┌─────────────────┐      ┌─────────────────┐
│  更新工具箱      │      │  更新工作台      │
│  ├─ 新的工具     │      │  ├─ 新的命令    │
│  ├─ 新的模板     │      │  ├─ 新的技能    │
│  └─ 新的能力     │      │  └─ 新的配置    │
│                 │      │                 │
│  但你的项目      │      │  把新能力        │
│  还没用到       │      │  应用到项目      │
└─────────────────┘      └─────────────────┘
```

---

## Level 6: 深入架构 (30 分钟)

### Q: 整个系统是如何工作的？

**数据流图**：

```
┌─────────────────────────────────────────────────────────────┐
│                      用户输入                                │
│                   "帮我实现一个 API"                         │
└─────────────────────────────┬───────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    Conductor Agent                          │
│  (理解需求，分解任务)                                         │
│  ├─ 查询 RAG：了解项目架构                                    │
│  ├─ 查询 Sessions：了解历史决策                               │
│  └─ 生成任务计划                                             │
└─────────────────────────────┬───────────────────────────────┘
                              │
              ┌───────────────┼───────────────┐
              ▼               ▼               ▼
    ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
    │  Architect  │ │   Builder   │ │  Reviewer   │
    │  设计架构   │ →  实现代码   │ →  审查代码   │
    └─────────────┘ └─────────────┘ └─────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    Librarian Agent                          │
│  (整理文档，更新知识库)                                       │
│  ├─ 更新 RAG：新架构决策                                      │
│  └─ 更新 Sessions：对话记录                                   │
└─────────────────────────────────────────────────────────────┘
```

**记忆系统**：

```
┌─────────────────────────────────────────────────────────────┐
│  ThinkingLens (对话记忆)                                     │
│  ├─ 记录每次对话的完整上下文                                  │
│  ├─ 可搜索历史对话                                           │
│  └─ 自动同步到项目                                           │
├─────────────────────────────────────────────────────────────┤
│  RAG System (项目知识)                                       │
│  ├─ 存储架构决策                                             │
│  ├─ 存储代码风格约定                                         │
│  └─ Agent 可以查询获取上下文                                  │
└─────────────────────────────────────────────────────────────┘
```

**质量门禁**：

```
git commit
     │
     ▼
┌─────────────────────────────────────────────────────────────┐
│  pre-commit hook                                            │
│  ├─ 运行质量检查                                             │
│  ├─ 检查代码行数                                             │
│  ├─ 检查文件大小                                             │
│  └─ 检查代码风格                                             │
└─────────────────────────────┬───────────────────────────────┘
                              │
                    ┌─────────┴─────────┐
                    ▼                   ▼
              通过 ✅              失败 ❌
                    │                   │
                    ▼                   ▼
              允许提交            阻止提交
```

---

## 快速参考

### 常用命令速查

```bash
# 初始化
smc init              # 全局配置初始化
smc template          # 新项目部署
smc sync              # 增量同步

# 技能管理
smc marketplace:list  # 浏览技能市场
smc skill:list        # 查看已安装技能

# 质量检查
smc qg:check          # 运行质量检查
smc config:validate   # 验证配置文件

# 项目规划
smc kickoff           # 启动项目规划
```

### 配置文件位置

```
~/.claude/config.json           # 全局配置
./.claude/settings.json         # 项目配置
./.claude/quality-gate.json     # 质量门禁配置
```

---

*更多细节查看 [README.md](./README.md)*
