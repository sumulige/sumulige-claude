# Sumulige Claude 常见问题

> 帮助你快速理解项目的核心设计理念

---

## Q1: 为什么要把 sumulige-claude 保留在项目中？

### 🔑 一句话答案
**它不是"工具"，是"数字合伙人"**——需要跟随项目一起成长。

### 📊 对比理解

| 普通 CLI 工具 | Sumulige Claude |
|--------------|-----------------|
| 全局安装，到处通用 | 嵌入项目，专属定制 |
| 静态能力，版本固定 | 动态进化，持续学习 |
| 扳手（用完即走） | 副驾驶（全程陪伴） |

### 💡 四大设计深意

```
┌─────────────────────────────────────────────────────────────┐
│  1️⃣ 共同进化                                                │
│     Agent 技能随业务逻辑同步迭代                             │
│     修改算法 → 同步更新 review 技能                          │
├─────────────────────────────────────────────────────────────┤
│  2️⃣ 上下文记忆                                               │
│     .claude/rag/ 是 Agent 的"海马体"                        │
│     项目架构决策 → 长期记忆沉淀                              │
├─────────────────────────────────────────────────────────────┤
│  3️⃣ 团队一致性                                               │
│     工具链即代码 (Toolchain as Code)                        │
│     git clone → pnpm install → 获得一致的 AI 环境            │
├─────────────────────────────────────────────────────────────┤
│  4️⃣ 构建联动                                                │
│     修改共享类型 → 自动触发 Agent 重新构建                   │
│     确保 AI 永不基于过时定义生成代码                         │
└─────────────────────────────────────────────────────────────┘
```

---

## Q2: 根目录 `.claude/` 和 `template/.claude/` 有什么区别？

### 🔑 一句话答案
**`template/` 是"工厂"，根目录 `.claude/` 是"产品"。**

### � 类比理解

```
template/.claude/          xxx/.claude/
     │                          │
     ▼                          ▼
🏭 安装光盘                  💾 存档文件
🎓 毕业证书模板              📝 你的毕业证
🧬 DNA 模板                  🧑 具体的人
📘 类定义 (Class)            📦 实例 (Instance)
```

### 🔍 详细对比

| 特性 | **根目录 `.claude/`** | **template/.claude/** |
|------|----------------------|----------------------|
| **性质** | 实例 (Instance) | 模板 (Blueprint) |
| **状态** | ✅ 有状态 | ❌ 无状态 |
| **内容** | sessions/, 本地配置, 项目 RAG | commands/, skills/, thinking-routes/ |
| **作用** | 记录"聊过什么" | 定义"能做什么" |
| **Git** | 部分忽略 (sessions/) | 完整提交 |
| **生命周期** | 随项目存在 | 发布即固化 |

### 🔄 工作流程

```
┌────────────────┐     smc template     ┌────────────────┐
│                │  ─────────────────▶  │                │
│ template/      │                      │ xxx/           │
│   .claude/     │     复制模板         │   .claude/     │
│   ├─commands/  │  ─────────────────▶  │   ├─commands/  │
│   ├─skills/    │                      │   ├─skills/    │
│   └─...        │                      │   ├─sessions/  │ ← 新增：对话记忆
│                │                      │   ├─rag/       │ ← 新增：项目知识
│                │                      │   └─...        │
└────────────────┘                      └────────────────┘
     工厂                                    产品
```

### 💡 设计优势

| 优势 | 说明 |
|------|------|
| **升级解耦** | 更新 template/ → 发布新版 → 用户项目历史不丢失 |
| **标准化** | 每个新项目自动获得最佳实践配置 |
| **隔离性** | 项目 A 的对话记忆不会污染项目 B |

---

## 总结：一张图看懂架构

```
┌─────────────────────────────────────────────────────────────┐
│                    Sumulige Claude 架构                      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────────────┐          ┌──────────────────┐        │
│  │  sumulige-claude │          │   你的项目        │        │
│  │  (npm 全局安装)   │          │   (xxx/)         │        │
│  ├──────────────────┤          ├──────────────────┤        │
│  │  cli.js          │──smc───▶│  .claude/         │        │
│  │  template/       │ template │   ├─ commands/   │        │
│  │   └─.claude/     │──────────│   ├─ skills/     │        │
│  │     ├─commands/  │  复制    │   ├─ sessions/   │ 记忆   │
│  │     ├─skills/    │          │   ├─ rag/        │ 知识   │
│  │     └─templates/ │          │   └─ settings    │ 配置   │
│  └──────────────────┘          └──────────────────┘        │
│         能力定义                      运行实例              │
│        (无状态)                      (有状态)              │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## Q3: `smc template` 和 `smc sync` 有什么区别？

### 🔑 一句话答案
**`template` 是"全屋装修"，`sync` 是"添置物品"。**

### 📊 对比理解

| 命令 | 行为 | 用途 | 风险 |
|------|------|------|------|
| `smc template` | **完整覆盖** | 新项目初始化 | ⚠️ 会覆盖已有文件 |
| `smc sync` | **增量同步** | 现有项目更新 | ✅ 只补缺少的 |

### 🏠 类比说明

```
smc template                    smc sync
────────────                    ────────

🏗️ 新房装修                      🛋️ 添置家具

空房子 ──→ 精装房                已住的房子 ──→ 补个沙发

全屋定制                         只买缺的
（窗帘+地板+沙发）               （只买沙发）

覆盖原有装修                     不动已有物品
```

### 🔄 使用流程

**场景 A：启动新项目**
```bash
mkdir my-new-project
cd my-new-project
smc template    # ✅ 一次性配置好所有 AI 能力
```

**场景 B：已有项目想用 sumulige-claude**
```bash
cd existing-project
smc sync        # ✅ 增量添加，不覆盖已有配置
```

### 📋 命令效果对比

| 操作 | smc template | smc sync |
|------|--------------|----------|
| `.claude/` 目录 | ✅ 创建/覆盖 | ✅ 补充缺失 |
| `CLAUDE.md` | ⚠️ 覆盖 | ✅ 保留已有 |
| `hooks/*` | ⚠️ 覆盖 | ✅ 保留已有 |
| `commands/*` | ⚠️ 覆盖 | ✅ 保留已有 |
| `sessions/` | ✅ 新建空目录 | ✅ 完整保留 |

### 💡 最佳实践

```
┌─────────────────────────────────────────────────────────────┐
│  判断流程                                                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  项目是空的？                                               │
│       │                                                     │
│       ├─ 是 → smc template                                 │
│       │        (全屋装修)                                   │
│       │                                                     │
│       └─ 否 → smc sync                                     │
│                (添置物品)                                   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### ⚠️ 注意事项

`smc template` 会**覆盖**以下关键文件：
- `.claude/CLAUDE.md` - 项目配置
- `.claude/hooks/*` - 钩子脚本
- `.claude/commands/*` - 命令定义

**v1.1.0 新增安全选项**：
- `smc template --safe`   - 跳过已存在的文件（不覆盖）
- `smc template --force`  - 强制覆盖（不备份）
- `smc template` (默认)   - 覆盖前自动备份到 `.claude/backup/`

### 🛡️ 安全机制

默认情况下，`smc template` 会自动备份被覆盖的文件：

```bash
smc template
# 会创建备份文件：.claude/backup/CLAUDE.2026-01-15.bak
```

如果你不想要任何备份（确定要覆盖），使用 `--force`：
```bash
smc template --force  # 不备份，直接覆盖
```

如果你想完全保留现有文件，使用 `--safe`：
```bash
smc template --safe  # 只添加缺失的文件
```

---

*更多问题？查看 [README.md](./README.md)*